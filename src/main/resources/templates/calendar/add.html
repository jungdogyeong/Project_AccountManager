<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>내역 입력</title>
    <link rel="stylesheet" th:href="@{/css/add.css}">
</head>
<body>

<div class="top-bar">
    <a th:href="@{/calendar/calendar(user_id=${transaction.userId})}" class="back-btn">‹</a>
    <h1>내역 입력</h1>
    <div class="placeholder"></div>
</div>

<form class="container" th:action="@{/calendar/add}" th:object="${transaction}" method="post">

    <input type="hidden" th:field="*{userId}" />
    <input type="hidden" th:field="*{date}" />

    <div style="display: none;">
        <input type="radio" id="radio_income" th:field="*{entryType}" value="INCOME">
        <input type="radio" id="radio_expense" th:field="*{entryType}" value="EXPENSE" th:checked="true">
    </div>

    <div class="tabs">
        <div class="tab income" id="incomeTab">수입</div>
        <div class="tab active expense" id="expenseTab">지출</div>
    </div>

    <div class="form-group">
        <select class="field" id="categorySelect" th:field="*{categoryId}" required>
        </select>
    </div>
    <div class="form-group amount-wrapper">
        <input type="number" class="field" id="amountInput" th:field="*{amount}" placeholder="0" required/>
    </div>
    <div class="form-group">
        <input type="text" class="field" th:field="*{memo}" placeholder="메모 (선택)"/>
    </div>
    <button type="submit" class="submit-btn">완료</button>

</form>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // 1. 폼 데이터와 연결된 '진짜' 라디오 버튼을 가져옵니다.
        const radioIncome = document.getElementById('radio_income');
        const radioExpense = document.getElementById('radio_expense');

        // 2. 눈에 보이는 '가짜' 탭 div를 가져옵니다.
        const incomeTab = document.getElementById('incomeTab');
        const expenseTab = document.getElementById('expenseTab');

        const amountInput = document.getElementById('amountInput');

        // 3. 탭을 업데이트하는 함수
        function updateTabs(activeTab) {
            if (activeTab === 'income') {
                // (스타일링) 눈에 보이는 탭의 active 클래스 변경 (원래 코드)
                incomeTab.classList.add('active', 'income');
                expenseTab.classList.remove('active', 'expense');

                // (기능) 숨겨진 라디오 버튼의 값을 'INCOME'으로 변경
                radioIncome.checked = true;

                // (스타일링) 금액 텍스트 색상 변경
                amountInput.classList.add('income-text');
                amountInput.classList.remove('expense-text');
            } else {
                // (스타일링) 눈에 보이는 탭의 active 클래스 변경 (원래 코드)
                expenseTab.classList.add('active', 'expense');
                incomeTab.classList.remove('active', 'income');

                // (기능) 숨겨진 라디오 버튼의 값을 'EXPENSE'로 변경
                radioExpense.checked = true;

                // (스타일링) 금액 텍스트 색상 변경
                amountInput.classList.add('expense-text');
                amountInput.classList.remove('income-text');
            }
        }

        // 4. 눈에 보이는 탭에 클릭 이벤트 연결
        incomeTab.addEventListener('click', () => updateTabs('income'));
        expenseTab.addEventListener('click', () => updateTabs('expense'));

        // 5. 페이지 로드 시 기본값(지출)에 맞춰 스타일 설정
        updateTabs('expense');
    });
</script>

</body>
</html>